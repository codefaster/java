package pr2.a07;import java.awt.Color;import java.awt.Graphics;import java.awt.Point;import java.beans.PropertyChangeEvent;import java.beans.PropertyChangeListener;import javax.swing.JPanel;public class SmileyView extends JPanel implements PropertyChangeListener {	int x;	int y;	int r;	int eyeSize;	int eyeAngle;	boolean isSmiling;	protected SmileyModel smileyModel;	public SmileyView(SmileyModel smileyModel) {		this.smileyModel = smileyModel;		r = smileyModel.r;		eyeSize = smileyModel.eyeSize;		eyeAngle = smileyModel.eyeAngle;		isSmiling = smileyModel.isSmiling;		x = smileyModel.x;		y = smileyModel.y;	}	public void moveRelative(int dx, int dy) {		x += dx;		y += dy;	}	public void setPosition(int x, int y) {		this.x = x;		this.y = y;	}	private static class Geo extends Point {		public static Circle getShrinked(Circle c, int size) {			return new Circle(				c.x,				c.y,				c.r - size			);		}		public static void makeCenter(Circle c) {			c.x -= c.r;			c.y -= c.r;		}		public static void alignLeft(Circle c) {			c.x -= c.d;		}		public static void alignRight(Circle c) {			c.x += c.d;		}		public static void alignUp(Circle c) {			c.y -= c.d;		}		public static void alignDown(Circle c) {			c.y += c.d;		}		public static Circle getAbsRotation(Circle axisCircle, double angle, int radius) {			final int DEG_COMP = 90;			final Point CENTER = axisCircle.getCenter();			double angleD = (angle - DEG_COMP) * Math.PI / 180;			return new Circle(				(int) Math.round((CENTER.x + axisCircle.r * Math.cos(angleD))),				(int) Math.round((CENTER.y + axisCircle.r * Math.sin(angleD))),				radius			);		}				public static int[] getCurve(int begin, int end) {			int [] result = new int [end-begin];			int relativeXValue=begin;			int faktor = 8;			int max = result.length-1*faktor;			for (int i=0; i<=max; i++) {				result [i] = (int) (Math.round(-0.25*Math.pow(relativeXValue, 2)-10*-0.25*relativeXValue)/faktor);				relativeXValue++;			}			return result;		}			}	public void propertyChange(PropertyChangeEvent evt) {		if (evt.getPropertyName() == "MODEL_UPDATE") {			 this.x = smileyModel.getX();			 this.y = smileyModel.getY();			 this.r = smileyModel.getRadius();			 this.eyeAngle = smileyModel.getEyeAngle();			 this.eyeSize = smileyModel.getEyeSize();			 this.isSmiling = smileyModel.getIsSmiling();		}	}		public void paintComponent(Graphics g) {		g.setColor(Color.ORANGE);		Circle head = new Circle(x, y, r);		g.fillOval(head.x, head.y, head.getDiameter(), head.getDiameter());		// Draw Eyes		g.setColor(Color.WHITE);		Circle eye1 = Geo.getAbsRotation(head, 270 + 45, eyeSize);		Circle eye2 = Geo.getAbsRotation(head, 90-45, eyeSize);		Geo.alignLeft(eye2);		g.drawOval(eye1.x, eye1.y, eye1.getDiameter(), eye1.getDiameter());		g.drawOval(eye2.x, eye2.y, eye2.getDiameter(), eye2.getDiameter());		Circle eyeBall1 = Geo.getAbsRotation(Geo.getShrinked(eye1,5), eyeAngle, eyeSize - eyeSize / 2);		Circle eyeBall2 = Geo.getAbsRotation(Geo.getShrinked(eye2,5), eyeAngle,eyeSize - eyeSize / 2);		// Draw Eyeballs		g.fillOval(eyeBall1.x, eyeBall1.y, eyeBall1.getDiameter(), eyeBall1.getDiameter());		g.fillOval(eyeBall2.x, eyeBall2.y, eyeBall2.getDiameter(), eyeBall2.getDiameter());		int [] smileCurveValues = Geo.getCurve(0, 40);		int [] frownCurveValues = Geo.getCurve(0, 20);		int xOffset = 20;		int yOffset = 50;		if (isSmiling == true) {			for (int x=0; x<smileCurveValues.length-10;x++) {				g.fillOval(xOffset+x,yOffset+smileCurveValues[x],2,2);			}		} else {			for (int x=0; x<frownCurveValues.length;x++) {				g.fillOval(xOffset+x,yOffset+frownCurveValues[x],2,2);			}		}	}}